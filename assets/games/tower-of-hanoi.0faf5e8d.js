const e=document.querySelectorAll(".tower"),t=document.querySelector("#auto-btn"),l=document.querySelector(".msg-display"),n=document.querySelector("#total-steps"),o=document.querySelector("#steps-counter"),d=document.querySelector("#inp-size"),r=document.querySelector("#speed"),i=document.querySelector("#reset");let a=100,u=3,s=0,c=[],p={plate:null,tower:null};const m=["tower-0","tower-1","tower-2"];let g=["79C99E","CB5D4E","FA7E61","5DA271","AB81CD","B5A886","73967D","689C77","4C1E4F","C84630","8093F1","B08EA2"];const v=()=>{c.length=0,e.forEach((e=>{e&&(e.innerHTML="")}));for(let e=u-1;e>=0;e--){let t=document.createElement("div");t.classList.add("plate"),t.setAttribute("id",`plate-${e}`),t.style.backgroundColor=`#${g[u-e]}`;let l=50+80/(u-1)*e;t.style.width=`${l}px`;let n=document.createTextNode(`#${e+1}`);t.appendChild(n),c.push(t)}c.forEach((t=>{e[0].appendChild(t)}))};v();const h=(e,t)=>{var n;document.getElementById(t).appendChild(e),s+=1,(null==(n=document.getElementById(t))?void 0:n.childElementCount)==u&&(l&&(l.innerHTML="Completed"),setTimeout((()=>{l&&(l.innerHTML="")}),2e3)),s.toString().length<y.length.toString().length?o&&(o.innerHTML="0"+s.toString()):o&&(o.innerHTML=s.toString())},E=(e,t)=>{let n=document.getElementById(e);if(null==n?void 0:n.childElementCount){let o=null==n?void 0:n.lastChild;h(o,t),((e,t)=>{var n;let o;o=(null==(n=document.getElementById(`tower-${t}`))?void 0:n.childElementCount)==u?"<p>Completed</p>":`<p>Moving plate from <span>Tower ${e=(parseInt(e)+1).toString()}</span> \n  to <span>Tower ${t=(parseInt(t)+1).toString()}</span></>`,l&&(l.innerHTML=o)})(e.substr(-1),t.substr(-1))}};window.handlePlateMoveWithTowers=E,c.forEach((e=>{e.addEventListener("click",(t=>{var l,n,o,d,r;console.log(`selected plate: ${null==(l=t.target)?void 0:l.id}`),e.parentElement.lastElementChild===e&&(null==p.plate?(p.plate=null==(n=t.target)?void 0:n.id,p.tower=null==(o=t.target)?void 0:o.parentNode.id,null==(d=document.getElementById(p.plate))||d.classList.add("selected")):(null==(r=document.getElementById(p.plate))||r.classList.remove("selected"),p.plate=null))}))})),e.forEach((e=>{e.addEventListener("click",(e=>{var t;let l=e.target,n=null==l?void 0:l.id;if("plate"===(null==l?void 0:l.className.split(" ")[0])&&(n=null==l?void 0:l.parentNode.id),p.tower!==n&&null!==p.plate&&(e=>{let t=document.getElementById(p.plate),l=e.lastChild,n=null==l?void 0:l.style.width;n=parseInt(null==n?void 0:n.slice(0,-2),10);let o=parseInt(null==t?void 0:t.style.width.slice(0,-2),10);return!l||n>o})(document.getElementById(n))){let e=document.getElementById(p.plate);h(e,n),null==(t=document.getElementById(p.plate))||t.classList.remove("selected"),p.plate=null,p.tower=null}}))}));let y=[];const L=(e,t,l,n)=>{1!=e?(L(e-1,t,n,l),y.push([t,n]),L(e-1,l,t,n)):y.push([t,n])};let S;const T=()=>{y.forEach(((e,t)=>{((e,t)=>{S=setTimeout((()=>{E(e[0],e[1]),t===y.length-1&&setTimeout((()=>{l&&(l.innerHTML="")}),1666)}),(t+1)*a)})(e,t)}))};function C(){let e=d.value;u=parseInt(e);let t=document.getElementById("inp-size-val");t&&(t.innerHTML=e.toString());let l=r.value;a=parseInt(l);let o=document.querySelector("#speed-val");o&&(o.innerHTML=l),v(),y=[],L(u,m[0],m[1],m[2]),n&&(n.innerHTML=y.length)}null==t||t.addEventListener("click",(()=>{C(),T()})),d&&d.addEventListener("change",(()=>{C()})),r&&r.addEventListener("change",(()=>{C()}));i.addEventListener("click",(()=>{clearTimeout(S),d.value="3",r.value="1000",a=100,u=3,s=0,s.toString().length<y.length.toString().length?o&&(o.innerHTML="0"+s.toString()):o&&(o.innerHTML=s.toString()),C()}));

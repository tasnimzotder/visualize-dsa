const e=document.querySelectorAll(".tower"),t=document.querySelector("#auto-btn"),l=document.querySelector(".msg-display"),n=document.querySelector("#total-steps"),o=document.querySelector("#steps-counter"),r=document.querySelector("#inp-size"),d=document.querySelector("#speed"),i=document.querySelector("#reset");let a=100,s=3,u=0,c=[],p={plate:null,tower:null};const m=["tower-0","tower-1","tower-2"],g=()=>{c.length=0,e.forEach((e=>{e&&(e.innerHTML="")}));for(let e=s-1;e>=0;e--){let t=document.createElement("div");t.classList.add("plate"),t.setAttribute("id",`plate-${e}`);let l=50+80/(s-1)*e;t.style.width=`${l}px`,c.push(t)}c.forEach((t=>{e[0].appendChild(t)}))};g();const h=(e,t)=>{document.getElementById(t).appendChild(e),u+=1,u.toString().length<E.length.toString().length?o&&(o.innerHTML="0"+u.toString()):o&&(o.innerHTML=u.toString())},v=(e,t)=>{let n=document.getElementById(e);if(null==n?void 0:n.childElementCount){let o=null==n?void 0:n.lastChild;h(o,t),((e,t)=>{let n=`<p>Moving plate from <span>Tower ${e=(parseInt(e)+1).toString()}</span> \n  to <span>Tower ${t=(parseInt(t)+1).toString()}</span></p>`;l&&(l.innerHTML=n)})(e.substr(-1),t.substr(-1))}};window.handlePlateMoveWithTowers=v,c.forEach((e=>{e.addEventListener("click",(t=>{var l,n,o,r,d;console.log(`selected plate: ${null==(l=t.target)?void 0:l.id}`),e.parentElement.lastElementChild===e&&(null==p.plate?(p.plate=null==(n=t.target)?void 0:n.id,p.tower=null==(o=t.target)?void 0:o.parentNode.id,null==(r=document.getElementById(p.plate))||r.classList.add("selected")):(null==(d=document.getElementById(p.plate))||d.classList.remove("selected"),p.plate=null))}))})),e.forEach((e=>{e.addEventListener("click",(e=>{var t;let l=e.target,n=null==l?void 0:l.id;if("plate"===(null==l?void 0:l.className.split(" ")[0])&&(n=null==l?void 0:l.parentNode.id),p.tower!==n&&null!==p.plate&&(e=>{let t=document.getElementById(p.plate),l=e.lastChild,n=null==l?void 0:l.style.width;n=parseInt(null==n?void 0:n.slice(0,-2),10);let o=parseInt(null==t?void 0:t.style.width.slice(0,-2),10);return!l||n>o})(document.getElementById(n))){let e=document.getElementById(p.plate);h(e,n),null==(t=document.getElementById(p.plate))||t.classList.remove("selected"),p.plate=null,p.tower=null}}))}));let E=[];const y=(e,t,l,n)=>{1!=e?(y(e-1,t,n,l),E.push([t,n]),y(e-1,l,t,n)):E.push([t,n])};let L;const S=()=>{E.forEach(((e,t)=>{((e,t)=>{L=setTimeout((()=>{v(e[0],e[1]),t===E.length-1&&setTimeout((()=>{l&&(l.innerHTML="")}),1666)}),(t+1)*a)})(e,t)}))};function w(){let e=r.value;s=parseInt(e);let t=document.getElementById("inp-size-val");t&&(t.innerHTML=e.toString());let l=d.value;a=parseInt(l);let o=document.querySelector("#speed-val");o&&(o.innerHTML=l),g(),E=[],y(s,m[0],m[1],m[2]),n&&(n.innerHTML=E.length)}null==t||t.addEventListener("click",(()=>{w(),S()})),r&&r.addEventListener("change",(()=>{w()})),d&&d.addEventListener("change",(()=>{w()}));i.addEventListener("click",(()=>{r.value="3",d.value="1000",a=100,s=3,u=0,u.toString().length<E.length.toString().length?o&&(o.innerHTML="0"+u.toString()):o&&(o.innerHTML=u.toString()),w(),clearTimeout(L)}));
